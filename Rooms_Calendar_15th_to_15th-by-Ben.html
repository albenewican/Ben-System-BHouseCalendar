<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rooms Calendar 15th-15th</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 1200px; margin: auto; }
    h1 { font-size: 24px; margin-bottom: 10px; }
    .button { padding: 5px 10px; margin: 2px; border: 1px solid #333; border-radius: 4px; cursor: pointer; }
    .button.selected { background-color: #333; color: white; }
    .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-top: 10px; }
    .day { padding: 10px; border-radius: 4px; text-align: center; cursor: pointer; background-color: #eee; }
    .day.out { background-color: red; color: white; }
    .summary { margin-top: 20px; display: flex; flex-wrap: wrap; gap: 10px; }
    .summary .room-summary { border: 1px solid #ccc; padding: 5px 10px; border-radius: 4px; min-width: 80px; text-align: center; }
    .month-nav { margin: 10px 0; display: flex; align-items: center; gap: 10px; }
    .month-nav button { padding: 5px 10px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Rooms Calendar (15th to 15th)</h1>

  <div id="rooms-buttons"></div>

  <div class="month-nav">
    <button id="prev-month">◀</button>
    <span id="month-label"></span>
    <button id="next-month">▶</button>
  </div>

  <div class="calendar" id="calendar"></div>

  <div class="summary">
    <h2 style="width:100%;">All Rooms Total Days Out</h2>
    <div id="all-rooms-summary" style="display:flex; flex-wrap: wrap;"></div>
  </div>

  <script>
    const ROOMS = Array.from({ length: 18 }, (_, i) => `R#${i + 1}`);
    const MONTHS = Array.from({ length: 12 }, (_, i) => new Date(0, i).toLocaleString('default', { month: 'long' }));

    let monthIndex = new Date().getMonth();
    let selectedRoom = ROOMS[0];
    let records = JSON.parse(localStorage.getItem('calendarRecords') || '{}');

    const roomsButtons = document.getElementById('rooms-buttons');
    const calendarDiv = document.getElementById('calendar');
    const monthLabel = document.getElementById('month-label');
    const allRoomsSummary = document.getElementById('all-rooms-summary');

    function renderRoomsButtons() {
      roomsButtons.innerHTML = '';
      ROOMS.forEach(room => {
        const btn = document.createElement('button');
        btn.textContent = room;
        btn.className = 'button' + (room === selectedRoom ? ' selected' : '');
        btn.onclick = () => { selectedRoom = room; renderCalendar(); renderSummary(); renderRoomsButtons(); };
        roomsButtons.appendChild(btn);
      });
    }

    function generateMonthDays(month) {
      const today = new Date();
      const lastDayCurrent = new Date(today.getFullYear(), month + 1, 0).getDate();
      const days = [];
      for (let day = 15; day <= lastDayCurrent; day++) days.push({day, month});
      const nextMonth = (month + 1) % 12;
      for (let day = 1; day <= 15; day++) days.push({day, month: nextMonth});
      return days;
    }

    function toggleDay(dayObj) {
      const key = `${selectedRoom}-${dayObj.month}-${dayObj.day}`;
      records[key] = !records[key];
      localStorage.setItem('calendarRecords', JSON.stringify(records));
      renderCalendar();
      renderSummary();
    }

    function totalOutForRoom(room) {
      const days = generateMonthDays(monthIndex);
      return days.reduce((count, dayObj) => {
        const key = `${room}-${dayObj.month}-${dayObj.day}`;
        return records[key] ? count + 1 : count;
      }, 0);
    }

    function renderCalendar() {
      monthLabel.textContent = `${MONTHS[monthIndex]} - ${MONTHS[(monthIndex+1)%12]}`;
      calendarDiv.innerHTML = '';
      const days = generateMonthDays(monthIndex);
      days.forEach(dayObj => {
        const key = `${selectedRoom}-${dayObj.month}-${dayObj.day}`;
        const dayDiv = document.createElement('div');
        dayDiv.textContent = dayObj.day;
        dayDiv.className = 'day' + (records[key] ? ' out' : '');
        dayDiv.onclick = () => toggleDay(dayObj);
        calendarDiv.appendChild(dayDiv);
      });
    }

    function renderSummary() {
      allRoomsSummary.innerHTML = '';
      ROOMS.forEach(room => {
        const div = document.createElement('div');
        div.className = 'room-summary';
        div.textContent = `${room}: ${totalOutForRoom(room)}`;
        allRoomsSummary.appendChild(div);
      });
    }

    document.getElementById('prev-month').onclick = () => { monthIndex = (monthIndex + 11) % 12; renderCalendar(); renderSummary(); };
    document.getElementById('next-month').onclick = () => { monthIndex = (monthIndex + 1) % 12; renderCalendar(); renderSummary(); };

    renderRoomsButtons();
    renderCalendar();
    renderSummary();
  </script>
</body>
</html>